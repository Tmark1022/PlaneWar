var __reflect=this&&this.__reflect||function(e,t,a){e.__class__=t,a?a.push(t):a=[t],e.__types__=e.__types__?a.concat(e.__types__):a},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function i(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}(),MovableBitMap=function(e){function t(t,a){var i=e.call(this,a)||this;return i.texture_name=t,i.texture=RES.getRes(i.texture_name),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i}return __extends(t,e),t.prototype.getTextureName=function(){return this.texture_name},t}(egret.Bitmap);__reflect(MovableBitMap.prototype,"MovableBitMap");var GameData=function(){function e(){}return e.planeCacheDict={},e.bulletCacheDict={},e.aeroliteCacheList=[],e.powerCacheDict={},e.BombCacheList=[],e.myPlane=null,e.guardPlaneLeft=null,e.guardPlaneRight=null,e.enemyPlaneOnStage=[],e.myBulletOnStage=[],e.enemyBulletOnStage=[],e.aeroliteOnStage=[],e.powerOnStage=[],e}();__reflect(GameData.prototype,"GameData");var Aerolite=function(e){function t(t){var a=e.call(this,t)||this;return a.speed=1,a.move_right=!0,a.blood=100,a.addEventListener(egret.Event.ADDED_TO_STAGE,a.onAddToStage,a),a}return __extends(t,e),t.createAerolite=function(e){if(GameData.aeroliteCacheList.length>0)for(var a=GameData.aeroliteCacheList,i=0;i<a.length;++i){var n=a[i];if(n.getTextureName()==e)return a.splice(i,1),n}return new t(e)},t.reclaimAerolite=function(e){null!=e&&GameData.aeroliteCacheList.push(e)},t.prototype.onAddToStage=function(e){this.move_right=!0,this.blood=100},t.prototype.isOutOfStage=function(){return this.x<0||this.x>GameData.stageW||this.y<0||this.y>GameData.stageH?!0:!1},t.prototype.moveByEnterFrame=function(){var e=this.rotation+=1;this.rotation>=180?this.rotation=e-360:this.rotation=e,null!=GameData.fpsOffset&&(this.x>GameData.stageW-this.width&&(this.move_right=!1),this.x<this.width&&(this.move_right=!0),this.move_right?this.x+=this.speed*GameData.fpsOffset:this.x-=this.speed*GameData.fpsOffset,this.y+=this.speed*GameData.fpsOffset)},t}(MovableBitMap);__reflect(Aerolite.prototype,"Aerolite");var ScrollBg=function(e){function t(){var t=e.call(this)||this;return t.scroll_speed=2,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddedToStage,t),t}return __extends(t,e),t.prototype.onAddedToStage=function(e){console.log("init ScrollBg successfully.")},t.prototype.refreshBgTextute=function(){this.initScrollBgData()},t.prototype.initScrollBgData=function(){this.bg_bitmap_array=[],this.stage_h=this.stage.stageHeight,this.stage_w=this.stage.stageWidth;var e,t=Math.floor(6*Math.random())+1;switch(t){case 1:e="bg_png";break;case 2:e="bg2_jpg";break;case 3:e="bg3_jpg";break;case 4:e="bg4_jpg";break;case 5:e="bg5_jpg";break;case 6:e="bg6_jpg";break;default:e="bg_png"}var a=RES.getRes(e);this.bg_picture_h=a.textureHeight,this.bg_bitmap_cnt=Math.ceil(this.stage_h/this.bg_picture_h)+1;for(var i=0;i<this.bg_bitmap_cnt;++i){var n=new egret.Bitmap;n.texture=a,n.width=this.stage_w,n.y=this.stage_h-this.bg_picture_h*(this.bg_bitmap_cnt-i),this.addChild(n),this.bg_bitmap_array.push(n)}},t.prototype.startScroll=function(){this.addEventListener(egret.Event.ENTER_FRAME,this.scrollBgBitMapSlotSFunc,this)},t.prototype.scrollBgBitMapSlotSFunc=function(e){for(var t=0;t<this.bg_bitmap_cnt;++t){var a=this.bg_bitmap_array[t];a.y+=this.scroll_speed,t==this.bg_bitmap_cnt-1&&a.y>this.stage_h&&(a.y=this.bg_bitmap_array[0].y-this.bg_picture_h,this.bg_bitmap_array.pop(),this.bg_bitmap_array.unshift(a))}},t.prototype.stopScroll=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.scrollBgBitMapSlotSFunc,this)},t.prototype.setScrollSpeed=function(e){0>=e||this.scroll_speed==e||e>this.bg_picture_h||(this.scroll_speed=e)},t}(egret.DisplayObjectContainer);__reflect(ScrollBg.prototype,"ScrollBg");var Bomb=function(e){function t(){var t=e.call(this)||this;t.texture_list=[];for(var a=0;23>a;++a)t.texture_list[a]=RES.getRes("explo_json.explo_m"+a.toString());return t.now_index=0,t.change_texture_timer=new egret.Timer(1e3/24,24),t.sound_music=RES.getRes("explo_mp3"),t.scaleX=1.3,t.scaleY=1.3,t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.removeFromStage,t),t.change_texture_timer.addEventListener(egret.TimerEvent.TIMER,t.changeTextureFunc,t),t.change_texture_timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,t.changeTextureCompleteFunc,t),t}return __extends(t,e),t.createBomb=function(){return GameData.BombCacheList.length>0?GameData.BombCacheList.pop():new t},t.prototype.onAddToStage=function(e){this.now_index=0,this.texture=this.texture_list[this.now_index],this.change_texture_timer.reset(),this.change_texture_timer.start(),this.sound_music.play(0,1)},t.prototype.removeFromStage=function(e){GameData.BombCacheList.push(this)},t.prototype.changeTextureFunc=function(e){this.texture=this.texture_list[this.now_index++]},t.prototype.changeTextureCompleteFunc=function(e){this.change_texture_timer.stop(),GameData.GameAppObj.removeChild(this)},t}(egret.Bitmap);__reflect(Bomb.prototype,"Bomb");var Bullet=function(e){function t(t,a){var i,n,r=this;switch(t){case 1:i="mybullet_json.mybullet_norm",n=20;break;case 2:i="mybullet_json.mybullet2",n=14;break;case 3:i="mybullet_json.bullet-self3-"+a.toString(),n=4;break;case 4:i="enemybullet_json.enemybullet1",n=20;break;case 5:i="enemybullet_json.enemybullet2",n=20;break;case 6:i="enemybullet_json.enemybullet3",n=20;break;case 7:i="enemybullet_json.enemybullet4",n=20}return r=e.call(this,i)||this,r.bullet_type=t,r.damage_init=n,r.damage=r.damage_init,r}return __extends(t,e),t.createBullet=function(e,a){var i;return i=t.getBulletObjFromCache(e,a),null==i&&(i=new t(e,a)),i},t.getBulletObjFromCache=function(e,t){var a=null;null==GameData.bulletCacheDict[e.toString()]&&(GameData.bulletCacheDict[e.toString()]=[]);var i=GameData.bulletCacheDict[e.toString()];if(i.length>0)if(3==e)for(var n=0;n<i.length;++n){var r=i[n];if(r.getTextureName()=="mybullet_json.bullet-self3-"+t.toString()){a=r,i.splice(n,1);break}}else a=i.pop();return a},t.reclaimBullet=function(e){if(null!=e){var t=e.bullet_type;null==GameData.bulletCacheDict[t.toString()]&&(GameData.bulletCacheDict[t.toString()]=[]);var a=GameData.bulletCacheDict[t.toString()];a.push(e)}},t.prototype.isOutOfStage=function(){return this.x<0||this.x>GameData.stageW||this.y<0||this.y>GameData.stageH?!0:!1},t.prototype.moveByEnterFrame=function(){this.y+=this.vertical_speed*GameData.fpsOffset,this.x+=this.horizontal_speed*GameData.fpsOffset},t.prototype.setVerticalSpeed=function(e){0!=e&&null!=e&&(this.vertical_speed=e)},t.prototype.setHorizontalSpeed=function(e){null!=e&&(this.horizontal_speed=e)},t}(MovableBitMap);__reflect(Bullet.prototype,"Bullet");var BulletEvent=function(e){function t(t,a,i){return void 0===a&&(a=!1),void 0===i&&(i=!1),e.call(this,t,a,i)||this}return __extends(t,e),t.CREATE_BULLET="createBullet",t}(egret.Event);__reflect(BulletEvent.prototype,"BulletEvent");var GameApp=function(e){function t(){var t=e.call(this)||this;return t.scroll_bg=null,t.enemy_plane_timer1=new egret.Timer(1e3),t.enemy_plane_timer2=new egret.Timer(1e4),t.enemy_plane_timer3=new egret.Timer(16e3),t.boss_coming_timer=new egret.Timer(98e3),t.create_boss_timer=new egret.Timer(3e3,1),t.aerolite_timer=new egret.Timer(15e3),t.bullet_music=RES.getRes("bullet_mp3"),t.bullet2_music=RES.getRes("bullet2_mp3"),t.warning_sound=RES.getRes("warning_mp3"),t.get_power_music=RES.getRes("getpower_mp3"),t.bg_music1=RES.getRes("bgmusic_mp3"),t.bg_music2=RES.getRes("bgmusic2_mp3"),t.bg_music_boss=RES.getRes("boss_music_mp3"),t.is_in_game=!1,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.createGameView()},t.prototype.createGameView=function(){GameData.stageW=this.stage.stageWidth,GameData.stageH=this.stage.stageHeight,GameData.targetFps=60,this.scroll_bg=new ScrollBg,this.addChild(this.scroll_bg),this.start_main_bg=new StartMainBg,this.addChild(this.start_main_bg),this.start_main_bg.start_button.touchEnabled=!0,this.start_main_bg.start_button.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchStartButton,this),null!=this.bg_music_channel&&this.bg_music_channel.stop(),this.bg_music_channel=this.bg_music2.play(0,-1),this.bg_music_channel.volume=1},t.prototype.touchStartButton=function(e){this.start_main_bg.start_button.touchEnabled=!1,this.start_main_bg.start_button.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchStartButton,this),this.removeChild(this.start_main_bg),this.gameStart()},t.prototype.gameStart=function(){if(GameData.fpsOffset=1,GameData.fpsLastRecordTime=0,GameData.Score=0,GameData.MissionId=1,this.is_in_game=!0,null==GameData.myPlane){var e=PlaneFactory.createPlane(1,"myplane_json.myplane");GameData.myPlane=e}GameData.myPlane.addEventListener(BulletEvent.CREATE_BULLET,this.createBullet,this),this.addChild(GameData.myPlane),GameData.InfoPanelObj.updateScore(),GameData.InfoPanelObj.updateBlood(GameData.myPlane.blood),GameData.InfoPanelObj.visible=!0,this.enemy_plane_timer1.addEventListener(egret.TimerEvent.TIMER,this.createEnemyPlane1,this),this.enemy_plane_timer2.addEventListener(egret.TimerEvent.TIMER,this.createEnemyPlane2,this),this.enemy_plane_timer3.addEventListener(egret.TimerEvent.TIMER,this.createEnemyPlane3,this),this.boss_coming_timer.addEventListener(egret.TimerEvent.TIMER,this.bosComingFunc,this),this.create_boss_timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.createBossPlane,this),this.aerolite_timer.addEventListener(egret.TimerEvent.TIMER,this.createAerolite,this),this.addEventListener(egret.Event.ENTER_FRAME,this.updateGameView,this),this.scroll_bg.refreshBgTextute(),this.scroll_bg.setScrollSpeed(2),this.scroll_bg.startScroll(),this.startTimeCount(),null!=this.bg_music_channel&&this.bg_music_channel.stop(),this.bg_music_channel=this.bg_music1.play(0,-1),this.bg_music_channel.volume=.4},t.prototype.startTimeCount=function(){this.enemy_plane_timer1.start(),this.enemy_plane_timer2.start(),this.enemy_plane_timer3.start(),this.boss_coming_timer.start(),this.aerolite_timer.start()},t.prototype.stopTimeCount=function(){this.enemy_plane_timer1.stop(),this.enemy_plane_timer2.stop(),this.enemy_plane_timer3.stop(),this.boss_coming_timer.stop(),this.aerolite_timer.stop()},t.prototype.gameStop=function(){this.is_in_game=!1,GameData.myPlane.removeEventListener(BulletEvent.CREATE_BULLET,this.createBullet,this),this.removeChild(GameData.myPlane),null!=GameData.guardPlaneLeft&&(GameData.guardPlaneLeft.removeEventListener(BulletEvent.CREATE_BULLET,this.createBullet,this),this.removeChild(GameData.guardPlaneLeft),GameData.guardPlaneLeft=null,GameData.guardPlaneRight.removeEventListener(BulletEvent.CREATE_BULLET,this.createBullet,this),this.removeChild(GameData.guardPlaneRight),GameData.guardPlaneRight=null);for(var e=0;e<GameData.enemyPlaneOnStage.length;++e){var t=GameData.enemyPlaneOnStage[e];this.removeChild(t),PlaneFactory.reclaimPlaneObjToCache(t)}GameData.enemyPlaneOnStage=[];for(var e=0;e<GameData.myBulletOnStage.length;++e){var a=GameData.myBulletOnStage[e];this.removeChild(a),Bullet.reclaimBullet(a)}GameData.myBulletOnStage=[];for(var e=0;e<GameData.enemyBulletOnStage.length;++e){var i=GameData.enemyBulletOnStage[e];this.removeChild(i),Bullet.reclaimBullet(i)}GameData.enemyBulletOnStage=[];for(var e=0;e<GameData.aeroliteOnStage.length;++e){var n=GameData.aeroliteOnStage[e];this.removeChild(n),Aerolite.reclaimAerolite(n)}GameData.aeroliteOnStage=[];for(var e=0;e<GameData.powerOnStage.length;++e){var r=GameData.powerOnStage[e];this.removeChild(r),Power.reclaimPower(r)}GameData.powerOnStage=[],this.enemy_plane_timer1.removeEventListener(egret.TimerEvent.TIMER,this.createEnemyPlane1,this),this.enemy_plane_timer2.removeEventListener(egret.TimerEvent.TIMER,this.createEnemyPlane2,this),this.enemy_plane_timer3.removeEventListener(egret.TimerEvent.TIMER,this.createEnemyPlane3,this),this.boss_coming_timer.removeEventListener(egret.TimerEvent.TIMER,this.bosComingFunc,this),this.create_boss_timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.createBossPlane,this),this.aerolite_timer.removeEventListener(egret.TimerEvent.TIMER,this.createAerolite,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.updateGameView,this),this.scroll_bg.stopScroll(),this.stopTimeCount(),null==this.end_main_bg&&(this.end_main_bg=new EndMainBg),this.end_main_bg.updateScore(),this.addChild(this.end_main_bg),this.end_main_bg.touchEnabled=!0,this.end_main_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchEndMainBg,this)},t.prototype.touchEndMainBg=function(e){this.end_main_bg.touchEnabled=!1,this.end_main_bg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.touchEndMainBg,this),this.removeChild(this.end_main_bg),GameData.InfoPanelObj.visible=!1,null==this.start_main_bg&&(this.start_main_bg=new StartMainBg),this.addChild(this.start_main_bg),this.start_main_bg.start_button.touchEnabled=!0,this.start_main_bg.start_button.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchStartButton,this),null!=this.bg_music_channel&&this.bg_music_channel.stop(),this.bg_music_channel=this.bg_music2.play(0,-1),this.bg_music_channel.volume=1},t.prototype.gameRestart=function(){},t.prototype.createGuardPlane=function(){var e;e=PlaneFactory.createPlane(2,"myplane_json.myplane_add"),e.addEventListener(BulletEvent.CREATE_BULLET,this.createBullet,this),e.x=0,e.y=e.height,e.scaleX=2,e.scaleY=2,this.addChild(e),GameData.guardPlaneLeft=e,egret.Tween.get(GameData.guardPlaneLeft).to({x:GameData.myPlane.x-GameData.guardPlaneLeft.space_width,y:GameData.myPlane.y},400,egret.Ease.circIn),egret.Tween.get(GameData.guardPlaneLeft).to({scaleX:.7,scaleY:.7},1500,egret.Ease.circIn),e=PlaneFactory.createPlane(2,"myplane_json.myplane_add"),e.addEventListener(BulletEvent.CREATE_BULLET,this.createBullet,this),e.x=GameData.stageW,e.y=e.height,e.scaleX=2,e.scaleY=2,this.addChild(e),GameData.guardPlaneRight=e,egret.Tween.get(GameData.guardPlaneRight).to({x:GameData.myPlane.x+GameData.guardPlaneRight.space_width,y:GameData.myPlane.y},400,egret.Ease.circIn),egret.Tween.get(GameData.guardPlaneRight).to({scaleX:.7,scaleY:.7},1500,egret.Ease.circIn)},t.prototype.createEnemyPlane1=function(e){var t,a=2+Math.floor(2*Math.random())+1;t=3==a?"enemyplane_json.enemyplane3":"enemyplane_json.enemyplane2";var i=PlaneFactory.createPlane(a,t);return null==i?void console.log("创建敌方飞机过程发生错误",a,t):(i.x=Math.random()*(GameData.stageW-i.width)+i.width/2,i.y=0,i.addEventListener(BulletEvent.CREATE_BULLET,this.createBullet,this),this.addChild(i),void GameData.enemyPlaneOnStage.push(i))},t.prototype.createEnemyPlane2=function(e){var t=5,a="enemyplane_json.enemyplane1",i=PlaneFactory.createPlane(t,a);return null==i?void console.log("创建敌方飞机过程发生错误",t,a):(i.x=Math.random()*(GameData.stageW-i.width)+i.width/2,i.y=0,i.addEventListener(BulletEvent.CREATE_BULLET,this.createBullet,this),this.addChild(i),void GameData.enemyPlaneOnStage.push(i))},t.prototype.createEnemyPlane3=function(e){var t=6,a="enemyplane_json.enemyplane4",i=PlaneFactory.createPlane(t,a);return null==i?void console.log("创建敌方飞机过程发生错误",t,a):(i.x=Math.random()*(GameData.stageW-i.width)+i.width/2,i.y=0,i.addEventListener(BulletEvent.CREATE_BULLET,this.createBullet,this),this.addChild(i),void GameData.enemyPlaneOnStage.push(i))},t.prototype.bosComingFunc=function(e){this.warning_sound.play(0,2),this.stopTimeCount(),this.create_boss_timer.reset(),this.create_boss_timer.start()},t.prototype.createBossPlane=function(e){this.create_boss_timer.stop();var t=7,a="enemyplane_json.BOSS",i=PlaneFactory.createPlane(t,a);return null==i?void console.log("创建敌方飞机过程发生错误",t,a):(i.x=Math.random()*(GameData.stageW-i.width)+i.width/2,i.y=0,i.addEventListener(BulletEvent.CREATE_BULLET,this.createBullet,this),this.addChild(i),GameData.enemyPlaneOnStage.push(i),null!=this.bg_music_channel&&this.bg_music_channel.stop(),this.bg_music_channel=this.bg_music_boss.play(0,-1),void(this.bg_music_channel.volume=.3))},t.prototype.createAerolite=function(e){var t="power_json.store",a=Aerolite.createAerolite(t);return null==a?void console.log("创建陨石过程发生错误",t):(a.x=Math.random()*(GameData.stageW-a.width)+a.width/2,a.y=0,this.addChild(a),void GameData.aeroliteOnStage.push(a))},t.prototype.createPower=function(e){var t=e.x,a=e.y,i=Math.floor(5*Math.random())+1,n=Power.createPower(i);return null==n?void console.log("创建power过程发生错误",i):(n.x=t,n.y=a,this.addChild(n),void GameData.powerOnStage.push(n))},t.prototype.createBomb=function(e){if(null!=e){var t=e.x,a=e.y,i=Bomb.createBomb();i.x=t,i.y=a,this.addChild(i)}},t.prototype.createBullet=function(e){var t=e.target;if(1==t.plane_type){var a=t;if(1==a.bullet_type){var i=1+a.getBulletLevel(),n=void 0;n=i%2==0?(i-1)/2:Math.floor(i/2);for(var r=0;i>r;++r){var s=Bullet.createBullet(a.bullet_type);s.x=a.x+25*(n-r),Math.abs(n-r)<1?s.y=a.y-a.width/5:s.y=a.y,s.setHorizontalSpeed(0),s.setVerticalSpeed(-10),this.addChild(s),GameData.myBulletOnStage.push(s)}this.bullet_music.play(0,1)}else if(2==a.bullet_type){for(var i=1+2*a.getBulletLevel(),n=Math.floor(i/2),r=0;i>r;++r){var s=Bullet.createBullet(a.bullet_type);s.x=a.x,s.y=a.y,s.rotation=(20-5*(n-1))*(r-n),s.setHorizontalSpeed(10*(s.rotation/60)),s.setVerticalSpeed(-10),this.addChild(s),GameData.myBulletOnStage.push(s)}this.bullet_music.play(0,1)}else if(3==a.bullet_type){for(var o=1;14>o;o++){var s=Bullet.createBullet(a.bullet_type,o);s.scaleX=a.getBulletLevel(),s.scaleY=a.getBulletLevel(),s.x=a.x,s.y=a.y-50*(o-1),s.setHorizontalSpeed(0),s.setVerticalSpeed(-40),s.damage=s.damage_init+2*(a.getBulletLevel()-1),this.addChildAt(s,1),GameData.myBulletOnStage.push(s)}this.bullet2_music.play(0,1)}}else if(2==t.plane_type){var s=Bullet.createBullet(t.bullet_type);s.x=t.x,s.y=t.y,s.setHorizontalSpeed(0),s.setVerticalSpeed(-10),this.addChild(s),GameData.myBulletOnStage.push(s)}else if(5==t.plane_type)for(var r=0;3>r;++r){var s=Bullet.createBullet(t.bullet_type);s.x=t.x,s.y=t.y,s.rotation=45*(1-r),s.setHorizontalSpeed(-10*(s.rotation/90)),s.setVerticalSpeed(10),this.addChild(s),GameData.enemyBulletOnStage.push(s)}else if(6==t.plane_type)for(var r=0;3>r;++r){var s=Bullet.createBullet(t.bullet_type);s.rotation=0,s.x=t.x+55*(1-r),s.y=t.y+t.width/3,s.setHorizontalSpeed(0),s.setVerticalSpeed(10),this.addChild(s),GameData.enemyBulletOnStage.push(s)}else if(7==t.plane_type)for(var r=0;7>r;++r){var s=Bullet.createBullet(t.bullet_type);s.x=t.x,s.y=t.y,s.rotation=(20-Math.abs(2*(3-r)))*(3-r),s.setHorizontalSpeed(-10*(s.rotation/90)+2*(r-3)),s.setVerticalSpeed(10),this.addChild(s),GameData.enemyBulletOnStage.push(s)}else{var s=Bullet.createBullet(t.bullet_type);s.x=t.x,s.y=t.y,s.setHorizontalSpeed(0),s.setVerticalSpeed(10),this.addChild(s),GameData.enemyBulletOnStage.push(s)}},t.prototype.moveAndCheckOutOfRangeHelp=function(e,t){for(var a=[],i=0;i<e.length;++i){var n=e[i];n.moveByEnterFrame(),n.isOutOfStage()&&a.push(n)}this.reclaimMovableBitMapHelp(e,a,t)},t.prototype.reclaimMovableBitMapHelp=function(e,t,a){for(var i=0;i<t.length;++i){var n=t[i];if(this.removeChild(n),e.splice(e.indexOf(n),1),a==PlaneFactory.reclaimPlaneObjToCache){n.removeEventListener(BulletEvent.CREATE_BULLET,this.createBullet,this)}a(n)}},t.prototype.updateGameView=function(e){var t=egret.getTimer();if(0==GameData.fpsLastRecordTime)GameData.fpsOffset=1;else{var a=1e3/(t-GameData.fpsLastRecordTime);GameData.fpsOffset=60/a}GameData.fpsLastRecordTime=t,this.moveAndCheckOutOfRangeHelp(GameData.enemyPlaneOnStage,PlaneFactory.reclaimPlaneObjToCache),this.moveAndCheckOutOfRangeHelp(GameData.myBulletOnStage,Bullet.reclaimBullet),this.moveAndCheckOutOfRangeHelp(GameData.enemyBulletOnStage,Bullet.reclaimBullet),this.moveAndCheckOutOfRangeHelp(GameData.aeroliteOnStage,Aerolite.reclaimAerolite),this.moveAndCheckOutOfRangeHelp(GameData.powerOnStage,Power.reclaimPower),this.gameHitTest()},t.prototype.gameHitTest=function(){if(0==GameData.myPlane.isInHurt()){for(var e=[],t=0;t<GameData.enemyBulletOnStage.length;++t){var a=GameData.enemyBulletOnStage[t];if(HitTest.hitTestP(GameData.myPlane,a,!0)){GameData.myPlane.blood-=a.damage,GameData.InfoPanelObj.updateBlood(GameData.myPlane.blood),e.push(a),GameData.myPlane.hurtStart();break}}this.reclaimMovableBitMapHelp(GameData.enemyBulletOnStage,e,Bullet.reclaimBullet)}if(0==GameData.myPlane.isInHurt())for(var t=0;t<GameData.enemyPlaneOnStage.length;++t){var i=GameData.enemyPlaneOnStage[t];if(HitTest.hitTestP(i,GameData.myPlane)){GameData.myPlane.blood-=100,GameData.InfoPanelObj.updateBlood(GameData.myPlane.blood);var n=RES.getRes("plane_bomb_mp3"),r=n.play(0,1);r.volume=.8;break}}if(0==GameData.myPlane.isInHurt())for(var t=0;t<GameData.aeroliteOnStage.length;++t){var s=GameData.aeroliteOnStage[t];if(HitTest.hitTestP(s,GameData.myPlane)){GameData.myPlane.blood-=100,GameData.InfoPanelObj.updateBlood(GameData.myPlane.blood);var n=RES.getRes("plane_bomb_mp3"),r=n.play(0,1);r.volume=.8;break}}for(var o=[],t=0;t<GameData.powerOnStage.length;++t){var l=GameData.powerOnStage[t];HitTest.hitTestP(GameData.myPlane,l)&&(l.powerWork(GameData.myPlane),this.get_power_music.play(0,1),o.push(l))}this.reclaimMovableBitMapHelp(GameData.powerOnStage,o,Power.reclaimPower);for(var h=[],m=[],t=0;t<GameData.myBulletOnStage.length;++t)for(var p=GameData.myBulletOnStage[t],_=0;_<GameData.enemyPlaneOnStage.length;++_){var i=GameData.enemyPlaneOnStage[_];if(!(i.blood<=0)&&HitTest.hitTestP(i,p)){i.blood-=p.damage,i.blood<=0&&(GameData.Score+=i.plane_score,GameData.InfoPanelObj.updateScore(),this.createBomb(i),m.push(i),7==i.plane_type&&(GameData.MissionId+=1,GameData.InfoPanelObj.updateScore(),this.startTimeCount(),this.bg_music_channel.stop(),this.bg_music_channel=this.bg_music1.play(0,-1),this.bg_music_channel.volume=.4)),h.push(p);break}}this.reclaimMovableBitMapHelp(GameData.myBulletOnStage,h,Bullet.reclaimBullet),this.reclaimMovableBitMapHelp(GameData.enemyPlaneOnStage,m,PlaneFactory.reclaimPlaneObjToCache);for(var u=[],c=[],t=0;t<GameData.myBulletOnStage.length;++t)for(var p=GameData.myBulletOnStage[t],_=0;_<GameData.aeroliteOnStage.length;++_){var s=GameData.aeroliteOnStage[_];if(!(s.blood<=0)&&HitTest.hitTestP(s,p)){s.blood-=p.damage,s.blood<=0&&(GameData.Score+=50,GameData.InfoPanelObj.updateScore(),this.createBomb(s),this.createPower(s),c.push(s)),u.push(p);break}}this.reclaimMovableBitMapHelp(GameData.myBulletOnStage,u,Bullet.reclaimBullet),this.reclaimMovableBitMapHelp(GameData.aeroliteOnStage,c,Aerolite.reclaimAerolite),GameData.myPlane.blood<=0&&this.gameStop()},t}(egret.DisplayObjectContainer);__reflect(GameApp.prototype,"GameApp");var Main=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){null!=GameData.GameAppObj&&1==GameData.GameAppObj.is_in_game&&(GameData.myPlane.blood=0,GameData.InfoPanelObj.updateBlood(GameData.myPlane.blood),GameData.GameAppObj.gameStop()),egret.ticker.resume()},this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("planewar")},t.prototype.onResourceLoadComplete=function(e){"planewar"==e.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),console.log("load resource successfully."),this.createGameScene())},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){"planewar"==e.groupName&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal)},t.prototype.createGameScene=function(){var e=new GameApp;this.addChild(e),GameData.GameAppObj=e;var t=new InfoPanel;this.addChild(t),GameData.InfoPanelObj=t,GameData.InfoPanelObj.visible=!1},t}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var HitTest=function(){function e(){}return e.hitTestP=function(e,t,a){return void 0===a&&(a=!1),e.hitTestPoint(t.x,t.y,a)?!0:!1},e}();__reflect(HitTest.prototype,"HitTest");var InfoPanel=function(e){function t(){var t=e.call(this)||this;return t.width=GameData.stageW,t.height=30,t.alpha=.6,t.min_blood=0,t.max_blood=100,t.graphics.beginFill(1602765),t.graphics.drawRect(0,0,t.width,t.height),t.score_text_field=new egret.TextField,t.score_text_field.x=0,t.score_text_field.y=0,t.addChild(t.score_text_field),t.HP_text_filed_temp=new egret.TextField,t.HP_text_filed_temp.x=GameData.stageW/2-50,t.HP_text_filed_temp.y=0,t.HP_text_filed_temp.text="HP:",t.addChild(t.HP_text_filed_temp),t.blood_shape=new egret.Shape,t.blood_shape.x=GameData.stageW/2,t.blood_shape.y=2.5,t.blood_shape.width=GameData.stageW/2,t.blood_shape.height=30,t.addChild(t.blood_shape),t.blood_width_radix=t.blood_shape.width/t.max_blood,t.HP_text_field=new egret.TextField,t.HP_text_field.x=t.blood_shape.x+t.blood_shape.width/3,t.HP_text_field.y=0,t.addChild(t.HP_text_field),t}return __extends(t,e),t.prototype.updateScore=function(){var e=GameData.Score;this.score_text_field.text="关卡"+GameData.MissionId+" 得分:"+e},t.prototype.updateBlood=function(e){e<this.min_blood?this.now_blood=this.min_blood:e>this.max_blood?this.now_blood=this.max_blood:this.now_blood=e;var t;t=this.now_blood>=80?8388352:this.now_blood>=30?15649024:13434880,this.blood_shape.graphics.clear(),this.blood_shape.graphics.beginFill(13421772),this.blood_shape.graphics.drawRoundRect(0,0,this.blood_shape.width,this.blood_shape.height-5,20),this.blood_shape.graphics.endFill(),this.blood_shape.graphics.beginFill(t),this.blood_shape.graphics.drawRoundRect(0,0,this.blood_width_radix*this.now_blood,this.blood_shape.height-5,20),this.blood_shape.graphics.endFill(),this.HP_text_field.text=this.now_blood+"/"+this.max_blood},t}(egret.Sprite);__reflect(InfoPanel.prototype,"InfoPanel");var StartMainBg=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.bg_bitmap=new egret.Bitmap,this.bg_bitmap.width=GameData.stageW,this.bg_bitmap.height=GameData.stageH,this.bg_bitmap.texture=RES.getRes("mainbg_jpg"),this.addChild(this.bg_bitmap),this.start_button=new egret.Bitmap,this.start_button.texture=RES.getRes("startbutton_png"),this.start_button.anchorOffsetX=this.start_button.width/2,this.start_button.anchorOffsetY=this.start_button.height/2,this.start_button.x=GameData.stageW/2,this.start_button.y=GameData.stageH/6*5,this.addChild(this.start_button)},t}(egret.Sprite);__reflect(StartMainBg.prototype,"StartMainBg");var EndMainBg=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.bg_shape=new egret.Shape,this.bg_shape.graphics.beginFill(9868950),this.bg_shape.graphics.drawRect(0,0,GameData.stageW,GameData.stageH),this.bg_shape.graphics.endFill(),this.bg_shape.alpha=.5,this.addChild(this.bg_shape),this.game_over_bitmap=new egret.Bitmap,this.game_over_bitmap.texture=RES.getRes("gameover_png");var e=this.game_over_bitmap.texture.textureHeight/this.game_over_bitmap.texture.textureWidth;this.game_over_bitmap.width=GameData.stageW,this.game_over_bitmap.height=this.game_over_bitmap.width*e,this.game_over_bitmap.anchorOffsetX=this.game_over_bitmap.width/2,this.game_over_bitmap.anchorOffsetY=this.game_over_bitmap.height/2,this.game_over_bitmap.x=GameData.stageW/2,this.game_over_bitmap.y=GameData.stageH/5*2,this.addChild(this.game_over_bitmap),this.text_field=new egret.TextField,this.text_field.width=GameData.stageW,this.text_field.x=0,this.text_field.y=GameData.stageH/6*4,this.text_field.textAlign="center",this.text_field.size=40,this.addChild(this.text_field)},t.prototype.updateScore=function(){this.text_field.text="到达关卡:"+GameData.MissionId+"\n\n\n总得分:"+GameData.Score},t}(egret.Sprite);__reflect(EndMainBg.prototype,"EndMainBg");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var PlaneBase=function(e){function t(t,a){var i=e.call(this,a)||this;return i.plane_type=t,i.speed=1,i.blood_init=0,i.blood_increase=0,i.blood=0,i.plane_score=0,i.fire_delay=0,i.fire_timer=null,i.bullet_type=1,i.bullet_event=new BulletEvent(BulletEvent.CREATE_BULLET),i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.onRemoveFromStage,i),i}return __extends(t,e),t.prototype.onAddToStage=function(e){this.blood=this.blood_init+(GameData.MissionId-1)*this.blood_increase,this.startFire()},t.prototype.onRemoveFromStage=function(e){this.stopFire()},t.prototype.isOutOfStage=function(){return this.x<0||this.x>GameData.stageW||this.y<0||this.y>GameData.stageH?!0:!1},t.prototype.moveByEnterFrame=function(){},t.prototype.setSpeed=function(e){0>=e||(this.speed=e)},t.prototype.setBlood=function(e){this.blood=e},t.prototype.startFire=function(){return null==this.fire_timer?void console.log(this.texture_name+"还没有初始化计时器就开火了"):(this.fire_timer.addEventListener(egret.TimerEvent.TIMER,this.createBullet,this),void this.fire_timer.start())},t.prototype.stopFire=function(){null!=this.fire_timer&&(this.fire_timer.removeEventListener(egret.TimerEvent.TIMER,this.createBullet,this),this.fire_timer.stop())},t.prototype.createBullet=function(e){this.dispatchEvent(this.bullet_event)},t}(MovableBitMap);__reflect(PlaneBase.prototype,"PlaneBase");var MyPlane=function(e){function t(a,i){var n=e.call(this,a,i)||this;return t.planeClassType!=a&&console.log("类MyPlane初始化时飞机类型校验不成功"+t.planeClassType+"!= "+a),n.blood_init=100,n.blood_increase=0,n.plane_score=0,n.blood=n.blood_init+(GameData.MissionId-1)*n.blood_increase,n.fire_delay=300,n.fire_timer=new egret.Timer(n.fire_delay),n.bullet_type=1,n.bullet_level=1,n.hurt_show_timer=new egret.Timer(1500/18,18),n.is_in_hurt=!1,n}return __extends(t,e),t.prototype.onAddToStage=function(e){this.x=GameData.stageW/2,this.y=GameData.stageH-this.width,this.touchEnabled=!0,this.bullet_level=1,this.bullet_type=1,this.blood=this.blood_init+(GameData.MissionId-1)*this.blood_increase,this.startFire(),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.stopTouchMove,this),this.hurt_show_timer.reset(),this.is_in_hurt=!1,this.hurt_show_timer.addEventListener(egret.TimerEvent.TIMER,this.hurtShowFunc,this),this.hurt_show_timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.hurtShowCompleteFunc,this)
},t.prototype.onRemoveFromStage=function(e){this.touchEnabled=!1,this.stopFire(),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopTouchMove,this),this.hurt_show_timer.removeEventListener(egret.TimerEvent.TIMER,this.hurtShowFunc,this),this.hurt_show_timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.hurtShowCompleteFunc,this)},t.prototype.startTouchMove=function(e){this.offsetX=e.stageX-this.x,this.offsetY=e.stageY-this.y,this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMoveFunc,this)},t.prototype.touchMoveFunc=function(e){var t=e.stageX-this.offsetX;t<this.width/2?this.x=this.width/2:t>GameData.stageW-this.width/2?this.x=GameData.stageW-this.width/2:this.x=t;var a=e.stageY-this.offsetY;if(a<this.height/2?this.y=this.height/2:a>GameData.stageH-this.height/2?this.y=GameData.stageH-this.height/2:this.y=a,null!=GameData.guardPlaneLeft){var i=GameData.guardPlaneLeft;i.x=this.x-i.space_width,i.y=this.y}if(null!=GameData.guardPlaneRight){var n=GameData.guardPlaneRight;n.x=this.x+n.space_width,n.y=this.y}},t.prototype.stopTouchMove=function(e){this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchMoveFunc,this)},t.prototype.getBulletLevel=function(){return this.bullet_level},t.prototype.setBulletLevel=function(e){0>=e||e>3||(this.bullet_level=e)},t.prototype.hurtShowFunc=function(e){1==this.alpha?this.alpha=.2:this.alpha=1},t.prototype.hurtShowCompleteFunc=function(e){this.alpha=1,this.hurtStop()},t.prototype.hurtStart=function(){if(!this.is_in_hurt){this.hurt_show_timer.start(),this.is_in_hurt=!0;var e=RES.getRes("plane_bomb_mp3"),t=e.play(0,1);t.volume=.8}},t.prototype.hurtStop=function(){this.hurt_show_timer.stop(),this.is_in_hurt=!1,this.hurt_show_timer.reset()},t.prototype.isInHurt=function(){return this.is_in_hurt},t.planeClassType=1,t}(PlaneBase);__reflect(MyPlane.prototype,"MyPlane");var GuardPlane=function(e){function t(a,i){var n=e.call(this,a,i)||this;return t.planeClassType!=a&&console.log("类GuardPlane初始化时飞机类型校验不成功"+t.planeClassType+"!= "+a),n.blood_init=0,n.blood_increase=0,n.plane_score=0,n.blood=n.blood_init+(GameData.MissionId-1)*n.blood_increase,n.fire_delay=500,n.fire_timer=new egret.Timer(n.fire_delay),n.bullet_type=1,n.space_width=60,n.scaleX=.7,n.scaleY=.7,n}return __extends(t,e),t.planeClassType=2,t}(PlaneBase);__reflect(GuardPlane.prototype,"GuardPlane");var NormalPlane1=function(e){function t(a,i){var n=e.call(this,a,i)||this;return t.planeClassType!=a&&console.log("类NormalPlane1初始化时飞机类型校验不成功"+t.planeClassType+"!= "+a),n.speed=4,n.blood_init=20,n.blood_increase=8,n.plane_score=10,n.blood=n.blood_init+(GameData.MissionId-1)*n.blood_increase,n.fire_delay=900,n.fire_timer=new egret.Timer(n.fire_delay),n.bullet_type=4,n}return __extends(t,e),t.prototype.moveByEnterFrame=function(){null!=GameData.fpsOffset&&(this.y+=this.speed*GameData.fpsOffset)},t.planeClassType=3,t}(PlaneBase);__reflect(NormalPlane1.prototype,"NormalPlane1");var NormalPlane2=function(e){function t(a,i){var n=e.call(this,a,i)||this;return t.planeClassType!=a&&console.log("类NormalPlane2初始化时飞机类型校验不成功"+t.planeClassType+"!= "+a),n.speed=4,n.blood_init=20,n.blood_increase=8,n.plane_score=10,n.blood=n.blood_init+(GameData.MissionId-1)*n.blood_increase,n.fire_delay=900,n.fire_timer=new egret.Timer(n.fire_delay),n.bullet_type=5,n}return __extends(t,e),t.prototype.moveByEnterFrame=function(){null!=GameData.fpsOffset&&(this.y+=this.speed*GameData.fpsOffset)},t.planeClassType=4,t}(PlaneBase);__reflect(NormalPlane2.prototype,"NormalPlane2");var NormalPlane3=function(e){function t(a,i){var n=e.call(this,a,i)||this;return n.move_right=!0,n.move_down=!0,t.planeClassType!=a&&console.log("类NormalPlane3初始化时飞机类型校验不成功"+t.planeClassType+"!= "+a),n.speed=2,n.blood_init=200,n.blood_increase=60,n.plane_score=100,n.blood=n.blood_init+(GameData.MissionId-1)*n.blood_increase,n.fire_delay=800,n.fire_timer=new egret.Timer(n.fire_delay),n.bullet_type=6,n.scaleX=2,n.scaleY=2,n}return __extends(t,e),t.prototype.moveByEnterFrame=function(){null!=GameData.fpsOffset&&(this.x>GameData.stageW-this.width&&(this.move_right=!1),this.x<this.width&&(this.move_right=!0),this.move_right?this.x+=2*this.speed*GameData.fpsOffset:this.x-=2*this.speed*GameData.fpsOffset,this.y>GameData.stageH-this.width&&(this.move_down=!1),1==this.move_down?this.y+=this.speed*GameData.fpsOffset:this.y-=1.5*this.speed*GameData.fpsOffset)},t.prototype.onAddToStage=function(e){this.blood=this.blood_init+(GameData.MissionId-1)*this.blood_increase,this.move_right=!0,this.move_down=!0,this.startFire()},t.planeClassType=5,t}(PlaneBase);__reflect(NormalPlane3.prototype,"NormalPlane3");var NormalPlane4=function(e){function t(a,i){var n=e.call(this,a,i)||this;return t.planeClassType!=a&&console.log("类NormalPlane4初始化时飞机类型校验不成功"+t.planeClassType+"!= "+a),n.speed=.5,n.blood_init=400,n.blood_increase=130,n.plane_score=100,n.blood=n.blood_init+(GameData.MissionId-1)*n.blood_increase,n.fire_delay=1e3,n.fire_timer=new egret.Timer(n.fire_delay),n.bullet_type=7,n.scaleX=2,n.scaleY=2,n}return __extends(t,e),t.prototype.moveByEnterFrame=function(){if(null!=GameData.fpsOffset){if(null!=GameData.myPlane)if(GameData.myPlane.x>this.x){var e=this.x+3*this.speed*GameData.fpsOffset;e>GameData.stageW-this.width?this.x=GameData.stageW-this.width:this.x=e}else{var e=this.x-3*this.speed*GameData.fpsOffset;e<this.width?this.x=this.width:this.x=e}this.y+=this.speed*GameData.fpsOffset}},t.planeClassType=6,t}(PlaneBase);__reflect(NormalPlane4.prototype,"NormalPlane4");var BossPlane=function(e){function t(a,i){var n=e.call(this,a,i)||this;return t.planeClassType!=a&&console.log("类BossPlane初始化时飞机类型校验不成功"+t.planeClassType+"!= "+a),n.speed=1,n.blood_init=5e3,n.blood_increase=1e3,n.plane_score=1e3,n.blood=n.blood_init+(GameData.MissionId-1)*n.blood_increase,n.fire_delay=400,n.fire_timer=new egret.Timer(n.fire_delay),n.bullet_type=7,n}return __extends(t,e),t.prototype.moveByEnterFrame=function(){null!=GameData.fpsOffset&&(this.x>GameData.stageW-this.width/2&&(this.move_right=!1),this.x<this.width/2&&(this.move_right=!0),this.move_right?this.x+=5*this.speed*GameData.fpsOffset:this.x-=5*this.speed*GameData.fpsOffset,this.y>GameData.stageH/2&&(this.move_down=!1),this.y<this.width/3&&(this.move_down=!0),1==this.move_down?this.y+=this.speed*GameData.fpsOffset:this.y-=2*this.speed*GameData.fpsOffset)},t.prototype.onAddToStage=function(e){this.blood=this.blood_init+(GameData.MissionId-1)*this.blood_increase,this.move_right=!0,this.move_down=!0;var t=this.fire_delay-10*(GameData.MissionId-1);300>t&&(t=300),this.fire_timer.delay=t;var a=1+.1*(GameData.MissionId-1);a>2&&(a=2),this.speed=a,this.startFire()},t.planeClassType=7,t}(PlaneBase);__reflect(BossPlane.prototype,"BossPlane");var PlaneFactory=function(){function e(){}return e.createPlane=function(t,a){var i;switch(t){case 1:i=new MyPlane(t,a);break;case 2:i=new GuardPlane(t,a);break;case 3:i=e.getPlaneObjFromCache(t,a),null==i&&(i=new NormalPlane1(t,a));break;case 4:i=e.getPlaneObjFromCache(t,a),null==i&&(i=new NormalPlane2(t,a));break;case 5:i=e.getPlaneObjFromCache(t,a),null==i&&(i=new NormalPlane3(t,a));break;case 6:i=e.getPlaneObjFromCache(t,a),null==i&&(i=new NormalPlane4(t,a));break;case 7:i=e.getPlaneObjFromCache(t,a),null==i&&(i=new BossPlane(t,a));break;default:i=null}return i},e.getPlaneObjFromCache=function(e,t){var a;if(null==GameData.planeCacheDict[e.toString()]&&(GameData.planeCacheDict[e.toString()]=[]),a=GameData.planeCacheDict[e.toString()],a.length>0)for(var i=0;i<a.length;++i){var n=a[i];if(n.getTextureName()==t)return a.splice(i,1),n}return null},e.reclaimPlaneObjToCache=function(e){if(null!=e){var t=e.plane_type,a=GameData.planeCacheDict[t.toString()];null==a&&(GameData.planeCacheDict[t.toString()]=a=[]),a.push(e)}},e}();__reflect(PlaneFactory.prototype,"PlaneFactory");var Power=function(e){function t(t){var a,i=this;switch(t){case 1:a=["power_json.power-bullet1-1","power_json.power-bullet1-2","power_json.power-bullet1-3","power_json.power-bullet1-4"];break;case 2:a=["power_json.power-bullet2-1","power_json.power-bullet2-2","power_json.power-bullet2-3","power_json.power-bullet2-4"];break;case 3:a=["power_json.power-bullet3-1","power_json.power-bullet3-2","power_json.power-bullet3-3","power_json.power-bullet3-4"];break;case 4:a=["power_json.bulletplane1","power_json.bulletplane2","power_json.bulletplane3","power_json.bulletplane4"];break;case 5:a=["power_json.power-blife"]}i=e.call(this,a[0])||this,i.speed=2,i.move_right=!0,i.power_type=t,i.texture_list=[],i.now_index=0,i.texture_timer=new egret.Timer(200),i.scaleX=1.3,i.scaleY=1.3;for(var n=0;n<a.length;++n)i.texture_list[n]=RES.getRes(a[n]);return i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i.addEventListener(egret.Event.REMOVED_FROM_STAGE,i.removeFromStage,i),i.texture_timer.addEventListener(egret.TimerEvent.TIMER,i.changeTexture,i),i}return __extends(t,e),t.createPower=function(e){null==GameData.powerCacheDict[e.toString()]&&(GameData.powerCacheDict[e.toString()]=[]);var a=GameData.powerCacheDict[e.toString()];return a.length>0?a.pop():new t(e)},t.reclaimPower=function(e){if(null!=e){var t=e.power_type;null==GameData.powerCacheDict[t.toString()]&&(GameData.powerCacheDict[t.toString()]=[]);var a=GameData.powerCacheDict[t.toString()];a.push(e)}},t.prototype.onAddToStage=function(e){this.move_right=!0,this.now_index=0,this.texture=this.texture_list[this.now_index],this.texture_timer.start()},t.prototype.removeFromStage=function(e){this.texture_timer.stop()},t.prototype.changeTexture=function(e){this.now_index+1>=this.texture_list.length?this.now_index=0:this.now_index+=1,this.texture=this.texture_list[this.now_index]},t.prototype.isOutOfStage=function(){return this.x<0||this.x>GameData.stageW||this.y<0||this.y>GameData.stageH?!0:!1},t.prototype.moveByEnterFrame=function(){null!=GameData.fpsOffset&&(this.x>GameData.stageW-this.width&&(this.move_right=!1),this.x<this.width&&(this.move_right=!0),this.move_right?this.x+=this.speed/2*GameData.fpsOffset:this.x-=this.speed/2*GameData.fpsOffset,this.y+=this.speed*GameData.fpsOffset)},t.prototype.powerWork=function(e){if(null!=e)switch(this.power_type){case 1:if(1==e.bullet_type)if(e.getBulletLevel()<3)e.setBulletLevel(e.getBulletLevel()+1);else{GameData.Score+=100,GameData.InfoPanelObj.updateScore();var t=new ScoreEffect(this,100);GameData.GameAppObj.addChild(t)}else e.bullet_type=1;break;case 2:if(2==e.bullet_type)if(e.getBulletLevel()<3)e.setBulletLevel(e.getBulletLevel()+1);else{GameData.Score+=100,GameData.InfoPanelObj.updateScore();var t=new ScoreEffect(this,100);GameData.GameAppObj.addChild(t)}else e.bullet_type=2;break;case 3:if(3==e.bullet_type)if(e.getBulletLevel()<3)e.setBulletLevel(e.getBulletLevel()+1);else{GameData.Score+=100,GameData.InfoPanelObj.updateScore();var t=new ScoreEffect(this,100);GameData.GameAppObj.addChild(t)}else e.bullet_type=3;break;case 4:if(null==GameData.guardPlaneLeft)GameData.GameAppObj.createGuardPlane();else{GameData.Score+=100,GameData.InfoPanelObj.updateScore();var t=new ScoreEffect(this,100);GameData.GameAppObj.addChild(t)}break;case 5:if(e.blood>=100){GameData.Score+=100,GameData.InfoPanelObj.updateScore();var t=new ScoreEffect(this,100);GameData.GameAppObj.addChild(t)}else{var a=e.blood+50;a>100?e.blood=100:e.blood=a,GameData.InfoPanelObj.updateBlood(e.blood)}}},t}(MovableBitMap);__reflect(Power.prototype,"Power");var ScoreEffect=function(e){function t(t,a){var i=e.call(this)||this;return i.score=a,i.display_timer=new egret.Timer(1e3,1),i.x=t.x-50,i.y=t.y,i.size=40,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(t,e),t.prototype.onAddToStage=function(e){this.text="+"+this.score,this.display_timer.reset(),this.display_timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.displayTimerComplete,this),this.display_timer.start()},t.prototype.displayTimerComplete=function(e){this.display_timer.stop(),this.display_timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.displayTimerComplete,this),GameData.GameAppObj.removeChild(this)},t}(egret.TextField);__reflect(ScoreEffect.prototype,"ScoreEffect");